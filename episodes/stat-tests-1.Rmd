---
title: 'Statistical tests'
teaching: 10
exercises: 2
---

:::::::::::::::::::::::::::::::::::::: questions 

- How do you write a lesson using R Markdown and `{sandpaper}`?

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: objectives

- Explain how to use markdown with the new lesson template
- Demonstrate how to include pieces of code, figures, and nested challenge blocks

::::::::::::::::::::::::::::::::::::::::::::::::

for dem alle følger vi metoden

1. Formulate hypotheses, 
2. Calculate test statistic, 
3. Determine p-value, 
4. Make decision


Den skal nok deles op. Og overskriftshierarkierne er et bud på hvordan.



## Enkeltprøve-tests

### One-sample chi-square test

#### Used for
Testing whether observed categorical frequencies differ from expected frequencies under a specified distribution.

#### Assumptions
- Observations are independent.  
- Categories are mutually exclusive and collectively exhaustive.  
- Expected count in each category is at least 5 (for the chi-square approximation to be valid).

#### Strengths
- Simple to compute and interpret.  
- Does not require the data to be normally distributed.  
- Applicable to any number of categories.

#### Weaknesses
- Sensitive to small expected counts (violates asymptotic approximation).  
- Does not indicate which categories contribute most to the discrepancy without further investigation.  
- Requires independence; cannot be used for paired or repeated measures.

#### Example

##### Hypothesis
- **Null hypothesis (H₀):** The proportions of outcomes equal the specified distribution.  
- **Alternative hypothesis (H₁):** At least one category’s proportion differs from the specified distribution.

```{r one_sample_chi_square_test}
# Observed counts of die rolls in 60 trials:
observed <- c(8, 12, 9, 11, 10, 10)

# Expected probabilities for a fair die:
p_expected <- rep(1/6, 6)

# Perform one-sample chi-square goodness-of-fit test:
test_result <- chisq.test(x = observed, p = p_expected)

# Show results:
test_result
```

Interpretation:
With a χ² statistic of `r round(test_result$statistic, 2) and a p-value of r signif(test_result$p.value, 3)`, we
`r if(test_result$p.value < 0.05) "reject the null hypothesis" else "fail to reject the null hypothesis"`.
This means that, given our data, there is
`r if(test_result$p.value < 0.05) "evidence that the die is not fair." else "no evidence to conclude the die is unfair."`


### One-sample z test

### One-sample t test

### One-sample Poisson test

### Shapiro–Wilk test for normalitet

### Kolmogorov–Smirnov én-prøve-test (goodness-of-fit)

### χ² goodness-of-fit test

## To-prøve-tests og parrede tests

### Two-sample F test


er det det samme som Two-sample F-test for variance?

We use this when we want to determine if two independent samples originate
from populations with the same variance.


### Paired t-test




### Two-sample t test (equal variances)

### Two-sample t test (unequal variances)

### Mann–Whitney U-test (Wilcoxon rank-sum)

### Wilcoxon signed-rank test

### Kolmogorov–Smirnov to-prøve-test

### Levene’s test for homoskedasticitet

### Bartlett’s test for homoskedasticitet

## Variansanalyse (ANOVA/ANCOVA)

### One-way ANOVA

### One-way ANCOVA

### Welch’s ANOVA (uden antagelse om lige varianser)

### Repeated-measures ANOVA

### Friedman test (nonparametrisk gentagne målinger)

### Post-hoc: Tukey HSD

### Post-hoc: Dunnett’s test

### Post-hoc: Bonferroni korrektion

## Ikke-parametriske k-prøve-tests

### Kruskal–Wallis test

### Rank correlation

### Anderson–Darling test

## Regression og korrelation

### Simple linear regression

### Multiple regression

### Pearson correlation

### Spearman’s rank correlation

### Kendall’s tau

### Multiple logistic regression

### Poisson regression

### Negative binomial regression

### Ordinal logistic regression

### Linear mixed-effects modeller (LME)

### Generalized linear mixed-effects modeller (GLMM)

### Generalized Estimating Equations (GEE)

## Kontingenstabel- og proportions-tests

### Contingency-table methods (χ² osv.)

### McNemar’s test

### Fisher’s exact test

### Barnard’s exact test

### Cochran–Armitage trend test (ordinal tabel)

### Cochran’s Q test (≥3 matched proportions)

### Stuart–Maxwell test (marginal homogenitet)

### Two-sample test for binomial proportions / Mantel–Haenszel test

### Chi-square test for R×C-tabeller

### Chi-square test for trend (Mantel-extension)

### Chi-square test for heterogenitet (2×k-tabeller)

## Incidens- og rate-tests

### One-sample test for incidence rates

### Two-sample comparison of incidence rates

### Trend-test for incidence rates over flere eksponeringsgrupper

### Exact rate ratio test

## Overlevelsesanalyse

### Log-rank test

### Parametric survival methods (Weibull)

### Cox proportional hazards model

### Accelerated Failure Time (AFT) modeller (eksponentiel, log-logistisk, …)

### Gray’s test for konkurrentrisiko

### Test af proportional hazards-antagelsen (Schoenfeld residualer)

## Aftale- og concordance-mål

### Kappa statistic

### Intraclass Correlation Coefficient (ICC)

### Bland–Altman analyse


# PROMPTEN
prompt: 
Jeg skal nu have lavet demoer af statistiske tests. Giv mig i det følgende Rmarkdown formatterede eksempler på en statistisk test. Formen skal være :
#### Used for

#### Assumptions

#### Strengths

#### Weaknesses

#### Example

##### Hypothesis

Bemækr at vi under example skal have et underpunkt der specificerer hvilken hypotese det er vi opstiller. Eksemplet skal også indeholde en tolkning af resultatet - med udgangspunkt i hypotesen.

Når jeg giver dig navnet på testen, svarer du med Rmarkdown formatteret output. R-koden skal pakkes ind i 
{r navn}

Hvor "navn" er R-chunkens navn der matcher den statistiske test. 
Alt på engelsk.

Forstået?

::::::::::::::::::::::::::::::::::::: keypoints 

- Use `.md` files for episodes when you want static content
- Use `.Rmd` files for episodes when you need to generate output
- Run `sandpaper::check_lesson()` to identify any issues with your lesson
- Run `sandpaper::build_lesson()` to preview your lesson locally

::::::::::::::::::::::::::::::::::::::::::::::::



